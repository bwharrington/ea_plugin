"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.deserializeFieldTypeArray = exports.isSerializedFieldTypeArray = exports.isValidTypeForFieldTypeArray = exports.FieldTypeArray = void 0;
const checks_1 = require("../../checks");
const literalfieldtype_1 = require("./literalfieldtype");
const scalarfieldtype_1 = require("./scalarfieldtype");
class FieldTypeArray {
    constructor(validTypesArray) {
        this.validTypesArray = validTypesArray;
    }
    getInnerTypes() {
        return this.validTypesArray;
    }
    getInnerNonArrayTypes() {
        return this.validTypesArray.filter((innerType) => (0, scalarfieldtype_1.isScalarFieldTypeEnum)(innerType) || (0, literalfieldtype_1.isLiteralFieldType)(innerType));
    }
    serialize() {
        return {
            'ND': false,
            'validTypes': this.validTypesArray.map((t) => ((0, scalarfieldtype_1.isScalarFieldTypeEnum)(t) ? t : t.serialize())),
        };
    }
}
exports.FieldTypeArray = FieldTypeArray;
function isValidTypeForFieldTypeArray(fieldType) {
    return (0, scalarfieldtype_1.isScalarFieldTypeEnum)(fieldType) || (0, literalfieldtype_1.isLiteralFieldType)(fieldType) || fieldType instanceof FieldTypeArray;
}
exports.isValidTypeForFieldTypeArray = isValidTypeForFieldTypeArray;
function isSerializedFieldTypeArray(fieldType, validateTypeCheck) {
    return ((0, checks_1.isObject)(fieldType) &&
        (0, checks_1.isBoolean)(fieldType['ND']) &&
        fieldType['ND'] === false &&
        (0, checks_1.isArray)(fieldType['validTypes']) &&
        fieldType['validTypes'].every((validType) => {
            return validateTypeCheck(validType);
        }));
}
exports.isSerializedFieldTypeArray = isSerializedFieldTypeArray;
function deserializeFieldTypeArray(serializedFieldTypeArray) {
    return new FieldTypeArray(serializedFieldTypeArray['validTypes'].map((t) => {
        if ((0, literalfieldtype_1.isSerializedLiteralFieldType)(t)) {
            return (0, literalfieldtype_1.deserializeLiteralFieldType)(t);
        }
        else if ((0, checks_1.isObject)(t)) {
            return deserializeFieldTypeArray(t);
        }
        return t;
    }));
}
exports.deserializeFieldTypeArray = deserializeFieldTypeArray;
