(()=>{"use strict";var e={9969:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isRawSendXHRResponse=i.commandTitles=void 0;const n=t(1225);i.commandTitles=new Map([["alta","AddLineTextArea"],["ami","AddMenuItem"],["asd","AddShapeData"],["a","Alert"],["av","AnimateViewport"],["b","Bootstrap"],["c","Confirm"],["cb","CreateBlock"],["cc","CreateCollection"],["cds","CreateDataSource"],["cl","CreateLine"],["cp","CreatePage"],["di","DeleteItem"],["dp","DeletePage"],["dsd","DeleteShapeData"],["d","Download"],["ee","ElementExists"],["ef","ExecuteFormula"],["gcl","GetConnectedLines"],["gcp","GetCurrentPage"],["gcs","GetCustomShape"],["gdif","GetDataItemField"],["get","GetElementType"],["gip","GetItemPageId"],["gp","GetProperty"],["grk","GetReferenceKey"],["grlp","GetRelativeLinePosition"],["gs","GetSelection"],["gsd","GetShapeData"],["hm","HideModal"],["hp","HidePanel"],["hci","HookCreateItems"],["hs","HookSelection"],["hte","HookTextEdit"],["k","KillExtension"],["lb","ListBlocks"],["lcf","ListCollectionFields"],["lc","ListCollections"],["ldi","ListDataItems"],["lds","ListDataSources"],["lg","ListGroups"],["ll","ListLines"],["lp","ListPages"],["lpr","ListProperties"],["lrk","ListReferenceKeys"],["lsd","ListShapeData"],["lta","ListTextAreas"],["lbc","LoadBlockClasses"],["log","LogForTestCase"],["oi","OffsetItems"],["pdi","PatchDataItems"],["rp","RegisterPanel"],["r","ReloadExtension"],["oauth","SendOAuthRequest"],["suim","SendUIMessage"],["xhr","SendXHR"],["scp","SetCurrentPage"],["sp","SetProperty"],["srk","SetReferenceKey"],["ssd","SetShapeData"],["sm","ShowModal"],["spn","ShowPanel"],["sleep","SleepForTestCase"],["throw","ThrowForTestCase"],["uci","UnhookCreateItems"],["us","UnhookSelection"],["ute","UnhookTextEdit"]]),i.isRawSendXHRResponse=function(e){return(0,n.isString)(e.url)&&(0,n.isString)(e.t)&&(0,n.isNumber)(e.s)&&(0,n.isObject)(e.h)}},9501:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.decodeBase64=void 0;const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=[];for(let e=0;e<t.length;e++)n[t.charCodeAt(e)]=e;i.decodeBase64=function(e){if((e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length%4!=0)throw new Error("Invalid base64 input; length must be a multiple of 4");let i=e.length/4*3;e.endsWith("==")?i-=2:e.endsWith("=")&&(i-=1);const t=new Uint8Array(i);let s=0;for(let r=0;r<i;r+=3){const i=n[e.charCodeAt(s++)],o=n[e.charCodeAt(s++)],l=n[e.charCodeAt(s++)],a=n[e.charCodeAt(s++)];t[r]=i<<2|o>>4,64!=l&&(t[r+1]=(15&o)<<4|l>>2),64!=a&&(t[r+2]=(3&l)<<6|a)}return t}},1225:(e,i)=>{function t(e){return null!=e}function n(e){return"number"==typeof e}function s(e){return"function"==typeof e}function r(e){const i=typeof e;return"object"==i&&null!=e||"function"==i}function o(e){return Array.isArray(e)}Object.defineProperty(i,"__esModule",{value:!0}),i.isPromise=i.isUnknown=i.isAny=i.isEmptyOrNullishObject=i.isTypedArray=i.isArray=i.isRecord=i.isObject=i.isFunction=i.isInt=i.isNumber=i.isBoolean=i.isString=i.isNullish=i.isDefAndNotNull=i.isUndefined=i.isNull=i.isDef=void 0,i.isDef=function(e){return void 0!==e},i.isNull=function(e){return null===e},i.isUndefined=function(e){return void 0===e},i.isDefAndNotNull=t,i.isNullish=function(e){return null==e},i.isString=function(e){return"string"==typeof e},i.isBoolean=function(e){return"boolean"==typeof e},i.isNumber=n,i.isInt=function(e){return n(e)&&isFinite(e)&&e%1==0},i.isFunction=s,i.isObject=r,i.isRecord=function(e){return function(i){return r(i)&&Object.values(i).every(e)}},i.isArray=o,i.isTypedArray=function(e){return function(i){return o(i)&&i.every(e)}},i.isEmptyOrNullishObject=function(e){return!(e&&"object"==typeof e&&Object.keys(e).find((i=>t(e[i]))))},i.isAny=function(e){return!0},i.isUnknown=function(e){return!0},i.isPromise=function(e){return r(e)&&s(e.then)&&s(e.catch)}},295:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isSerializedBaseFieldTypeDefinition=i.deserializeBaseFieldTypeDefinition=i.serializeBaseFieldTypeDefinition=i.isBaseFieldTypeDefinition=i.isAnyFieldTypeArray=void 0;const n=t(1225),s=t(1745),r=t(8424),o=t(4972),l=t(1798),a=t(9947);function d(e){return e instanceof r.FieldTypeArray||e instanceof l.NDimensionalFieldTypeArray}function c(e){return(0,n.isDefAndNotNull)(a.ScalarFieldTypeEnum[e])||(0,o.isSerializedLiteralFieldType)(e)||(0,s.isSerializedCollectionEnumFieldType)(e)||(0,r.isSerializedFieldTypeArray)(e,c)||(0,l.isSerializedNDimensionalFieldTypeArray)(e)}i.isAnyFieldTypeArray=d,i.isBaseFieldTypeDefinition=function(e){return(0,a.isScalarFieldTypeEnum)(e)||(0,o.isLiteralFieldType)(e)||d(e)||(0,s.isCollectionEnumFieldType)(e)},i.serializeBaseFieldTypeDefinition=function(e){return e instanceof o.LiteralFieldType||e instanceof r.FieldTypeArray||e instanceof l.NDimensionalFieldTypeArray||e instanceof s.CollectionEnumFieldType?e.serialize():e},i.deserializeBaseFieldTypeDefinition=function(e){return(0,o.isSerializedLiteralFieldType)(e)?(0,o.deserializeLiteralFieldType)(e):(0,s.isSerializedCollectionEnumFieldType)(e)?(0,s.deserializeCollectionEnumFieldType)(e):(0,r.isSerializedFieldTypeArray)(e,c)?(0,r.deserializeFieldTypeArray)(e):(0,l.isSerializedNDimensionalFieldTypeArray)(e)?(0,l.deserializeNDimensionalFieldTypeArray)(e):e},i.isSerializedBaseFieldTypeDefinition=c},1745:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isSerializedCollectionEnumFieldType=i.deserializeCollectionEnumFieldType=i.isCollectionEnumFieldType=i.CollectionEnumFieldType=i.CollectionEnumFieldNames=i.CollectionEnumFieldTypeKey=void 0;const n=t(1225);var s;i.CollectionEnumFieldTypeKey="COLLECTION_ENUM",function(e){e.Name="name",e.Id="id",e.Description="description",e.Color="color",e.IconUrl="iconUrl"}(s=i.CollectionEnumFieldNames||(i.CollectionEnumFieldNames={}));class r{constructor(e){this.collectionId=e}serialize(){return{[i.CollectionEnumFieldTypeKey]:this.collectionId}}}i.CollectionEnumFieldType=r,r.PRIMARY_KEY=s.Id,i.isCollectionEnumFieldType=e=>e instanceof r,i.deserializeCollectionEnumFieldType=function(e){return new r(e[i.CollectionEnumFieldTypeKey])},i.isSerializedCollectionEnumFieldType=function(e){return(0,n.isObject)(e)&&(0,n.isString)(e[i.CollectionEnumFieldTypeKey])}},8424:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.deserializeFieldTypeArray=i.isSerializedFieldTypeArray=i.isValidTypeForFieldTypeArray=i.FieldTypeArray=void 0;const n=t(1225),s=t(4972),r=t(9947);class o{constructor(e){this.validTypesArray=e}getInnerTypes(){return this.validTypesArray}getInnerNonArrayTypes(){return this.validTypesArray.filter((e=>(0,r.isScalarFieldTypeEnum)(e)||(0,s.isLiteralFieldType)(e)))}serialize(){return{ND:!1,validTypes:this.validTypesArray.map((e=>(0,r.isScalarFieldTypeEnum)(e)?e:e.serialize()))}}}i.FieldTypeArray=o,i.isValidTypeForFieldTypeArray=function(e){return(0,r.isScalarFieldTypeEnum)(e)||(0,s.isLiteralFieldType)(e)||e instanceof o},i.isSerializedFieldTypeArray=function(e,i){return(0,n.isObject)(e)&&(0,n.isBoolean)(e.ND)&&!1===e.ND&&(0,n.isArray)(e.validTypes)&&e.validTypes.every((e=>i(e)))},i.deserializeFieldTypeArray=function e(i){return new o(i.validTypes.map((i=>(0,s.isSerializedLiteralFieldType)(i)?(0,s.deserializeLiteralFieldType)(i):(0,n.isObject)(i)?e(i):i)))}},3547:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isSerializedFieldTypeDefinition=i.SerializedAnyFieldType=i.deserializeFieldTypeDefinition=i.serializeFieldTypeDefinition=i.isAnyFieldType=i.AnyFieldType=i.isSubtypeOfFieldType=i.fieldTypesEqual=void 0;const n=t(1225),s=t(295),r=t(1745),o=t(8424),l=t(4972),a=t(1798),d=t(9947);i.fieldTypesEqual=function e(i,t,s=!0){if(i===t)return!0;if((0,l.isLiteralFieldType)(i)&&(0,l.isLiteralFieldType)(t))return i.getLiteral()===t.getLiteral();if((0,r.isCollectionEnumFieldType)(i)&&(0,r.isCollectionEnumFieldType)(t))return!s||i.collectionId===t.collectionId;i=(0,n.isArray)(i)?i:[i],t=(0,n.isArray)(t)?t:[t];const d=new Set(i),c=new Set(t);if(d.size!==c.size)return!1;for(const t of c)if(!d.has(t))if((0,l.isLiteralFieldType)(t)){if(!i.some((i=>(0,l.isLiteralFieldType)(i)&&e(i,t))))return!1}else if(t instanceof o.FieldTypeArray){if(!i.some((i=>i instanceof o.FieldTypeArray&&e(i.validTypesArray,t.validTypesArray))))return!1}else{if(!(0,a.isNDimensionalFieldTypeArray)(t))return!1;{const n=i.find(a.isNDimensionalFieldTypeArray);if(!n||!e(n.validTypesArray,t.validTypesArray))return!1}}return!0},i.isSubtypeOfFieldType=function e(i,t){if((0,n.isArray)(t)||(t=[t]),(0,n.isArray)(i))return i.every((i=>e(i,t)));if(t.includes(d.ScalarFieldTypeEnum.ANY))return!0;if((0,d.isScalarFieldTypeEnum)(i))return t.includes(i);if((0,l.isLiteralFieldType)(i)){if(t.includes(i.getScalarFieldType()))return!0;if(t.filter(l.isLiteralFieldType).find((e=>i.getLiteral()===e.getLiteral())))return!0;const n=t.filter(s.isAnyFieldTypeArray);for(const t of n)if(e(i,t.getInnerTypes()))return!0;return!1}if((0,r.isCollectionEnumFieldType)(i))return t.filter(r.isCollectionEnumFieldType).some((e=>e.collectionId===i.collectionId));if((0,a.isNDimensionalFieldTypeArray)(i))return!!t.filter(a.isNDimensionalFieldTypeArray).find((t=>e(i.validTypesArray,t.validTypesArray)));const o=i.getInnerTypes(),c=t.filter(s.isAnyFieldTypeArray);for(const i of c)if(e(o,i.getInnerTypes()))return!0;return!1},i.AnyFieldType=[...d.AnyScalarFieldType,new a.NDimensionalFieldTypeArray(d.AnyScalarFieldType)],i.isAnyFieldType=function(e){let t;return!!(e===d.ScalarFieldTypeEnum.ANY||e===i.AnyFieldType||(0,n.isArray)(e)&&e.includes(d.ScalarFieldTypeEnum.NUMBER)&&e.includes(d.ScalarFieldTypeEnum.STRING)&&e.includes(d.ScalarFieldTypeEnum.BOOLEAN)&&e.includes(d.ScalarFieldTypeEnum.COLOR)&&e.includes(d.ScalarFieldTypeEnum.DATE)&&e.includes(d.ScalarFieldTypeEnum.NULL)&&e.includes(d.ScalarFieldTypeEnum.DICTIONARY)&&e.includes(d.ScalarFieldTypeEnum.CURRENCY)&&!e.some(l.isLiteralFieldType)&&(t=e.find(a.isNDimensionalFieldTypeArray))&&t.validTypesArray.includes(d.ScalarFieldTypeEnum.NUMBER)&&t.validTypesArray.includes(d.ScalarFieldTypeEnum.STRING)&&t.validTypesArray.includes(d.ScalarFieldTypeEnum.BOOLEAN)&&t.validTypesArray.includes(d.ScalarFieldTypeEnum.COLOR)&&t.validTypesArray.includes(d.ScalarFieldTypeEnum.DATE)&&t.validTypesArray.includes(d.ScalarFieldTypeEnum.DICTIONARY)&&t.validTypesArray.includes(d.ScalarFieldTypeEnum.NULL)&&t.validTypesArray.includes(d.ScalarFieldTypeEnum.CURRENCY)&&!t.validTypesArray.some(l.isLiteralFieldType))},i.serializeFieldTypeDefinition=e=>(0,n.isArray)(e)?e.map(s.serializeBaseFieldTypeDefinition):(0,s.serializeBaseFieldTypeDefinition)(e),i.deserializeFieldTypeDefinition=e=>(0,n.isArray)(e)?e.map(s.deserializeBaseFieldTypeDefinition):(0,s.deserializeBaseFieldTypeDefinition)(e),i.SerializedAnyFieldType=(0,i.serializeFieldTypeDefinition)(i.AnyFieldType),i.isSerializedFieldTypeDefinition=function(e){return(0,n.isArray)(e)?e.every(s.isSerializedBaseFieldTypeDefinition):(0,s.isSerializedBaseFieldTypeDefinition)(e)}},4972:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.deserializeLiteralFieldType=i.isSerializedLiteralFieldType=i.isLiteralFieldType=i.LiteralFieldType=void 0;const n=t(1225),s=t(9947);class r{constructor(e){this.scalarFieldType=s.ScalarFieldTypeEnum.ANY,(0,n.isString)(e)?(this.literal=e.substring(r.literalStringPrefix.length),this.scalarFieldType=s.ScalarFieldTypeEnum.STRING):(0,n.isBoolean)(e)?(this.literal=e,this.scalarFieldType=s.ScalarFieldTypeEnum.BOOLEAN):(this.literal=e,this.scalarFieldType=s.ScalarFieldTypeEnum.NUMBER)}getLiteral(){return this.literal}getScalarFieldType(){return this.scalarFieldType}serialize(){return this.scalarFieldType===s.ScalarFieldTypeEnum.STRING?r.literalStringPrefix+this.literal:this.literal.toString()}}i.LiteralFieldType=r,r.literalStringPrefix="%",i.isLiteralFieldType=function(e){return e instanceof r},i.isSerializedLiteralFieldType=function(e){return(0,n.isString)(e)},i.deserializeLiteralFieldType=function(e){if(e.startsWith(r.literalStringPrefix))return new r(e);const i=Number(e);return isNaN(i)||i===Number.POSITIVE_INFINITY||i===Number.NEGATIVE_INFINITY?new r("true"===e):new r(i)}},1798:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.deserializeNDimensionalFieldTypeArray=i.isSerializedNDimensionalFieldTypeArray=i.isNDimensionalFieldTypeArray=i.isValidTypeForNDimensionalFieldTypeArray=i.NDimensionalFieldTypeArray=void 0;const n=t(1225),s=t(4972),r=t(9947);class o{constructor(e){this.validTypesArray=e}getInnerTypes(){return[...this.validTypesArray,this]}getInnerNonArrayTypes(){return this.validTypesArray.filter((e=>(0,r.isScalarFieldTypeEnum)(e)||(0,s.isLiteralFieldType)(e)))}serialize(){return{ND:!0,validTypes:this.validTypesArray.map((e=>(0,r.isScalarFieldTypeEnum)(e)?e:e.serialize()))}}}i.NDimensionalFieldTypeArray=o,i.isValidTypeForNDimensionalFieldTypeArray=function(e){return(0,r.isScalarFieldTypeEnum)(e)||(0,s.isLiteralFieldType)(e)},i.isNDimensionalFieldTypeArray=function(e){return e instanceof o},i.isSerializedNDimensionalFieldTypeArray=function(e){return(0,n.isObject)(e)&&(0,n.isBoolean)(e.ND)&&!0===e.ND&&(0,n.isTypedArray)(n.isAny)(e.validTypes)&&e.validTypes.every((e=>(0,n.isDefAndNotNull)(r.ScalarFieldTypeEnum[e])||(0,s.isSerializedLiteralFieldType)(e)))},i.deserializeNDimensionalFieldTypeArray=function(e){return new o(e.validTypes.map((e=>(0,s.isSerializedLiteralFieldType)(e)?(0,s.deserializeLiteralFieldType)(e):e)))}},9947:(e,i)=>{var t;Object.defineProperty(i,"__esModule",{value:!0}),i.isScalarFieldTypeEnum=i.AnyScalarFieldType=i.ScalarFieldTypeEnum=void 0,function(e){e[e.ANY=0]="ANY",e[e.NUMBER=1]="NUMBER",e[e.BOOLEAN=2]="BOOLEAN",e[e.STRING=3]="STRING",e[e.COLOR=4]="COLOR",e[e.DATE=5]="DATE",e[e.NULL=6]="NULL",e[e.DICTIONARY=7]="DICTIONARY",e[e.CURRENCY=8]="CURRENCY",e[e.DATEONLY=9]="DATEONLY"}(t=i.ScalarFieldTypeEnum||(i.ScalarFieldTypeEnum={})),i.AnyScalarFieldType=[t.ANY,t.NUMBER,t.STRING,t.BOOLEAN,t.COLOR,t.DATE,t.DATEONLY,t.NULL,t.DICTIONARY,t.CURRENCY];const n=new Set(i.AnyScalarFieldType);i.isScalarFieldTypeEnum=e=>n.has(e)},8005:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isSerializedFlattenedReference=i.isUnTypedSerializedFlattenedReference=i.isTypedSerializedFlattenedReference=i.FlattenedReferenceKeyName=i.FlattenedReferenceKeyId=void 0;const n=t(1225);function s(e){return(0,n.isObject)(e)&&(0,n.isObject)(e.sc)&&(0,n.isObject)(e.d)}function r(e){return(0,n.isObject)(e)&&!0===e[i.FlattenedReferenceKeyId]}i.FlattenedReferenceKeyId="192d0e9f-2f5a-4032-9f03-59bbf1ea5891",i.FlattenedReferenceKeyName="192d0e9f-2f5a-4032-9f03-59bbf1ea5891_n",i.isTypedSerializedFlattenedReference=s,i.isUnTypedSerializedFlattenedReference=r,i.isSerializedFlattenedReference=function(e){return r(e)||s(e)}},289:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isSerializedFields=i.isSerializedFieldType=i.isSerializedLucidDateObject=i.isSerializedLucidCurrency=i.isSerializedLucidDictionary=i.isSerializedColorObjectFieldType=void 0;const n=t(1225);function s(e){return(0,n.isObject)(e)&&(0,n.isObject)(e.color)}function r(e){return(0,n.isObject)(e)&&Object.values(e).every(a)}function o(e){return(0,n.isObject)(e)&&(0,n.isNumber)(e.a)&&(0,n.isString)(e.t)}function l(e){var i;return(0,n.isObject)(e)&&(0,n.isNumber)(e.ms)&&(0,n.isBoolean)(null===(i=e.isDateOnly)||void 0===i||i)}function a(e){return null==e||(0,n.isNumber)(e)||(0,n.isString)(e)||(0,n.isBoolean)(e)||r(e)||o(e)||(0,n.isArray)(e)&&e.every(a)||l(e)||s(e)}i.isSerializedColorObjectFieldType=s,i.isSerializedLucidDictionary=r,i.isSerializedLucidCurrency=o,i.isSerializedLucidDateObject=l,i.isSerializedFieldType=a,i.isSerializedFields=function(e){return(0,n.isObject)(e)&&Object.values(e).every(a)}},6459:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0})},6122:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0})},7195:(e,i)=>{var t;Object.defineProperty(i,"__esModule",{value:!0}),i.isLinearOffsetType=i.OffsetType=void 0,function(e){e[e.NW=0]="NW",e[e.NE=1]="NE",e[e.SE=2]="SE",e[e.SW=3]="SW",e[e.MOVE=4]="MOVE",e[e.ROTATE=5]="ROTATE",e[e.SCALE=6]="SCALE",e[e.CUSTOM=7]="CUSTOM",e[e.N=8]="N",e[e.E=9]="E",e[e.S=10]="S",e[e.W=11]="W"}(t=i.OffsetType||(i.OffsetType={})),i.isLinearOffsetType=function(e){return e===t.NW||e===t.NE||e===t.SE||e===t.SW||e===t.MOVE||e===t.N||e===t.E||e===t.S||e===t.W}},2341:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isSerializedDataError=void 0;const n=t(1225);i.isSerializedDataError=function(e){return(0,n.isObject)(e)&&(0,n.isString)(e.error)&&(0,n.isNumber)(e.type)}},4812:(e,i)=>{var t;Object.defineProperty(i,"__esModule",{value:!0}),i.ShapeDataInheritance=void 0,(t=i.ShapeDataInheritance||(i.ShapeDataInheritance={}))[t.NONE=0]="NONE",t[t.NAME=1]="NAME",t[t.VALUE=2]="VALUE"},6443:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CollectionProxy=void 0;const n=t(5962),s=t(5186),r=t(3081);class o extends s.PropertyStoreProxy{constructor(e,i){super(e,i),this.id=e,this.items=new n.MapProxy((()=>this.client.sendCommand("ldi",{id:this.id})),(e=>new r.DataItemProxy(e,this,this.client)))}getName(){return this.properties.get("Name")}getBranchedFrom(){const e=this.properties.get("BranchedFrom");return e?new o(e,this.client):void 0}patchItems(e){var i,t;const n={};if(e.changed)for(const[i,t]of e.changed)n[i]=t;this.client.sendCommand("pdi",{id:this.id,a:null!==(i=e.added)&&void 0!==i?i:[],c:n,d:null!==(t=e.deleted)&&void 0!==t?t:[]})}getFields(){return this.client.sendCommand("lcf",{id:this.id})}}i.CollectionProxy=o},7258:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DataError=void 0,i.DataError=class{constructor(e,i){this.error=e,this.type=i}}},3081:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DataItemProxy=void 0;const n=t(5962);i.DataItemProxy=class{constructor(e,i,t){this.primaryKey=e,this.collection=i,this.client=t,this.fields=new n.MapProxy((()=>this.client.sendCommand("lcf",{id:this.collection.id})),(e=>this.client.sendCommand("gdif",{c:this.collection.id,pk:this.primaryKey,f:e})))}}},1582:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DataProxy=void 0;const n=t(5962),s=t(9594);i.DataProxy=class{constructor(e){this.client=e,this.dataSources=new n.MapProxy((()=>this.client.sendCommand("lds",void 0)),(e=>new s.DataSourceProxy(e,this.client)))}addDataSource(e,i){return new s.DataSourceProxy(this.client.sendCommand("cds",{n:e,s:i}),this.client)}}},9594:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DataSourceProxy=void 0;const n=t(1225),s=t(3547),r=t(5962),o=t(5186),l=t(6443);class a extends o.PropertyStoreProxy{constructor(e,i){super(e,i),this.id=e,this.collections=new r.MapProxy((()=>this.client.sendCommand("lc",{id:this.id})),(e=>new l.CollectionProxy(e,this.client)))}addCollection(e,i){return new l.CollectionProxy(this.client.sendCommand("cc",{s:this.id,n:e,f:i.fields.map((e=>({n:e.name,t:(0,s.serializeFieldTypeDefinition)(e.type)}))),p:i.primaryKey}),this.client)}getName(){return this.properties.get("Name")}getSourceConfig(){const e=this.properties.get("Upstream");return(0,n.isObject)(e)?e.SourceConfig:{}}}i.DataSourceProxy=a},6039:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.parseReferenceKeyDefinition=i.serializeReferenceKeyDefinition=i.isCollectionReferenceKeyDefinition=void 0;const n=t(1225),s=t(8005),r=t(3291);function o(e){return(0,n.isString)(e.collectionId)}i.isCollectionReferenceKeyDefinition=o,i.serializeReferenceKeyDefinition=function(e){return o(e)?{cid:e.collectionId,pk:e.primaryKey,wl:e.fieldWhitelist,ro:e.readonly}:{sc:(0,r.serializeSchemaDefinition)(e.schema),n:e.name,d:e.data}},i.parseReferenceKeyDefinition=function(e){if((0,s.isTypedSerializedFlattenedReference)(e))return{schema:(0,r.parseSchemaDefinition)(e.sc),name:e.n,data:e.d};if((0,s.isUnTypedSerializedFlattenedReference)(e))throw new Error("Untyped serialized flattened references not implemented");return{collectionId:e.cid,primaryKey:e.pk,fieldWhitelist:e.wl,readonly:e.ro}}},7415:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ReferenceKeyProxy=void 0;const n=t(8005),s=t(6443),r=t(6039);i.ReferenceKeyProxy=class{constructor(e,i,t,n){this.elementId=e,this.key=i,this.client=t,this.settings=n}get collectionId(){if(!(0,n.isSerializedFlattenedReference)(this.settings))return this.settings.cid}get primaryKey(){if(!(0,n.isSerializedFlattenedReference)(this.settings))return this.settings.pk}get definition(){return(0,r.parseReferenceKeyDefinition)(this.settings)}getItem(){const e=this.collectionId;if((0,n.isSerializedFlattenedReference)(this.settings)||!e)throw new Error("Not implemented for flattened references");return new s.CollectionProxy(e,this.client).items.get(this.settings.pk)}}},3291:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.parseSchemaDefinition=i.serializeSchemaDefinition=void 0;const n=t(3547);i.serializeSchemaDefinition=function(e){return{Fields:e.fields.map((e=>({Name:e.name,Type:(0,n.serializeFieldTypeDefinition)(e.type)}))),PrimaryKey:e.primaryKey}},i.parseSchemaDefinition=function(e){return{fields:e.Fields.map((e=>({name:e.Name,type:(0,n.deserializeFieldTypeDefinition)(e.Type)}))),primaryKey:e.PrimaryKey}}},9373:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.findProxyClass=void 0;const n=t(2440),s=[t(7826).ERDBlockProxy,n.CustomBlockProxy];i.findProxyClass=function(e){return s.find((i=>i.classNameRegex.test(e)))}},2440:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CustomBlockProxy=void 0;const n=t(1225),s=t(5663);class r extends s.BlockProxy{isFromStencil(e,i){const t=this.properties.get("Stencil");if((0,n.isObject)(t)){const s=this.client.sendCommand("gp",{p:"Stencil-"+t.id});if((0,n.isObject)(s)&&(0,n.isObject)(s.sourcePackage))return s.sourcePackage.packageId===lucid.getPackageId()&&s.sourcePackage.library===e&&s.sourcePackage.shape===i}return!1}getStencilTextAreaName(e){return this.textAreas.keys().find((i=>i.endsWith("_"+e)))}}i.CustomBlockProxy=r,r.classNameRegex=/^CustomBlock$/},7826:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ERDBlockProxy=i.ERDFieldProxy=void 0;const n=t(5663);class s{constructor(e,i){this.block=e,this.index=i}getName(){return this.block.properties.get("Field"+this.index)}getType(){var e;return null!==(e=this.block.properties.get("Type"+this.index))&&void 0!==e?e:""}getKey(){var e;return null!==(e=this.block.properties.get("Key"+this.index))&&void 0!==e?e:""}}i.ERDFieldProxy=s;class r extends n.BlockProxy{getName(){return this.properties.get("Name")}getFieldCount(){return this.properties.get("Fields")}getFields(){const e=[],i=this.getFieldCount();for(let t=1;t<=i;t++)e.push(new s(this,t));return e}}i.ERDBlockProxy=r,r.classNameRegex=/^ERDEntityBlock(2|3|4)?$/},9445:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0})},5663:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BlockProxy=void 0;const n=t(251);class s extends n.ItemProxy{getClassName(){return this.properties.get("ClassName")}getRotation(){return this.properties.get("Rotation")}getConnectedLines(){return this.client.sendCommand("gcl",this.id).map((e=>this.client.getLineProxy(e)))}linkText(e,i,t){if(!this.textAreas.keys().includes(e))throw new Error("Invalid text area key");if(!this.referenceKeys.keys().includes(i))throw new Error("Invalid reference key");this.properties.set(e+"_Link",{ref:i,f:t})}}i.BlockProxy=s},912:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DocumentProxy=void 0;const n=t(4229),s=t(5962),r=t(3379);class o extends n.ElementProxy{constructor(e){super(void 0,e),this.pages=new s.MapProxy((()=>this.client.sendCommand("lp",void 0)),(e=>new r.PageProxy(e,this.client)))}static getNextHookName(){return"__documentproxy__hook"+o.nextHookId++}addPage(e){const i=this.client.sendCommand("cp",void 0),t=new r.PageProxy(i,this.client);return t.setTitle(e.title),t}setTitle(e){this.properties.set("Title",e)}getTitle(){return this.properties.get("Title")}hookCreateItems(e){const i=o.getNextHookName();return this.client.registerAction(i,(i=>{e(i.ids.map((e=>this.client.getItemProxy(e))))})),this.client.sendCommand("hci",{n:i}),i}unhookCreateItems(e){this.client.deleteAction(e),this.client.sendCommand("uci",{n:e})}}i.DocumentProxy=o,o.nextHookId=0},4229:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ElementProxy=void 0;const n=t(6039),s=t(7415),r=t(5962),o=t(5186),l=t(6355);class a extends o.PropertyStoreProxy{constructor(e,i){super(e,i),this.shapeData=new l.ShapeDataProxy(this.id,this.client),this.allShapeData=new r.MapProxy((()=>this.client.sendCommand("lsd",{id:this.id,i:!0})),(e=>l.ShapeDataProxy.parseData(this.client.sendCommand("gsd",{id:this.id,n:e})))),this.referenceKeys=new r.MapProxy((()=>this.client.sendCommand("lrk",{id:this.id})),(e=>new s.ReferenceKeyProxy(this.id,e,this.client,this.client.sendCommand("grk",{id:this.id,k:e}))))}setReferenceKey(e,i){this.client.sendCommand("srk",{id:this.id,k:e,v:(0,n.serializeReferenceKeyDefinition)(i)})}removeReferenceKey(e){this.client.sendCommand("srk",{id:this.id,k:e})}exists(){return this.client.sendCommand("ee",{id:this.id})}executeFormula(e){return l.ShapeDataProxy.parseData(this.client.sendCommand("ef",{id:this.id||"",f:e}))}}i.ElementProxy=a},7548:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GroupProxy=void 0;const n=t(251),s=t(9746),r=t(5962);class o extends n.ItemProxy{constructor(){super(...arguments),this.blocks=new r.MapProxy((()=>this.client.sendCommand("lb",{id:this.id})),(e=>this.client.getBlockProxy(e))),this.lines=new r.MapProxy((()=>this.client.sendCommand("ll",{id:this.id})),(e=>new s.LineProxy(e,this.client))),this.groups=new r.MapProxy((()=>this.client.sendCommand("lg",{id:this.id})),(e=>new o(e,this.client))),this.allBlocks=new r.MapProxy((()=>this.client.sendCommand("lb",{id:this.id,d:!0})),(e=>this.client.getBlockProxy(e))),this.allLines=new r.MapProxy((()=>this.client.sendCommand("ll",{id:this.id,d:!0})),(e=>new s.LineProxy(e,this.client))),this.allGroups=new r.MapProxy((()=>this.client.sendCommand("lg",{id:this.id,d:!0})),(e=>new o(e,this.client)))}}i.GroupProxy=o},251:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ItemProxy=void 0;const n=t(7195),s=t(4229),r=t(5962);class o extends s.ElementProxy{constructor(e,i){super(e,i),this.id=e,this.textAreas=new r.WriteableMapProxy((()=>this.client.sendCommand("lta",this.id)),(e=>this.client.sendCommand("gp",{id:this.id,p:e})),((e,i)=>this.client.sendCommand("sp",{id:this.id,p:e,v:i})))}getBoundingBox(){return this.properties.get("BoundingBox")}setBoundingBox(e){const i=this.getBoundingBox();i.x===e.x&&i.y===e.y||this.offset(n.OffsetType.MOVE,{x:e.x-i.x,y:e.y-i.y}),i.w===e.w&&i.h===e.h||this.offset(n.OffsetType.SE,{x:e.w-i.w,y:e.h-i.h})}getPage(){return this.client.getPageProxy(this.client.sendCommand("gip",this.id))}getLocation(){const e=this.getBoundingBox();return{x:e.x,y:e.y}}setLocation(e){const i=this.getBoundingBox();i.x===e.x&&i.y===e.y||this.offset(n.OffsetType.MOVE,{x:e.x-i.x,y:e.y-i.y})}offset(e,i){this.client.sendCommand("oi",{ids:[this.id],t:e,o:i})}delete(){this.client.sendCommand("di",this.id)}getContainers(){return this.executeFormula("LABEL(CONTAINEDBY)").map((e=>this.client.getBlockProxy(e)))}}i.ItemProxy=o},9269:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0})},9746:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.LineProxy=void 0;const n=t(1225),s=t(5663),r=t(251),o=t(2849);class l extends r.ItemProxy{getConnection(e){let i;if(e.Block&&(i=this.client.getBlockProxy(e.Block)),e.Line&&(i=this.client.getLineProxy(e.Line)),!i||i.exists())return i}isBlockEndpointDefinition(e){return e.connection instanceof s.BlockProxy}isLineEndpointDefinition(e){return e.connection instanceof l}parseLineEndpointDefinition(e){const i=this.getConnection(e);return i instanceof l?{connection:i,style:e.Style,position:e.Position,x:e.x,y:e.y}:i?{connection:i,style:e.Style,linkX:e.LinkX,linkY:e.LinkY,inside:e.Inside,autoLink:e.AutoLink,padding:e.Padding,x:e.x,y:e.y}:{style:e.Style,x:e.x,y:e.y}}serializeLineEndpointDefinition(e){if(this.isBlockEndpointDefinition(e)){const i=e.connection.getBoundingBox();return{Style:e.style,x:i.x+i.w*e.linkX,y:i.y+i.h*e.linkY,Block:e.connection.id,LinkX:e.linkX,LinkY:e.linkY,Inside:e.inside,AutoLink:e.autoLink,Padding:e.padding}}return this.isLineEndpointDefinition(e)?Object.assign({Style:e.style,Line:e.connection.id,LineP:e.position},e.connection.getRelativePosition(e.position)):{Style:e.style,x:e.x,y:e.y}}getEndpoint1(){return this.parseLineEndpointDefinition(this.properties.get("Endpoint1"))}getEndpoint2(){return this.parseLineEndpointDefinition(this.properties.get("Endpoint2"))}setEndpoint1(e){this.properties.set("Endpoint1",this.serializeLineEndpointDefinition(e))}setEndpoint2(e){this.properties.set("Endpoint2",this.serializeLineEndpointDefinition(e))}getUpstreamConnection(){return this.getEndpoint1().connection}getDownstreamConnection(){return this.getEndpoint2().connection}getConnectedLines(){return this.client.sendCommand("gcl",this.id).map((e=>this.client.getLineProxy(e)))}getRelativePosition(e){return this.client.sendCommand("grlp",{id:this.id,p:e})}getTextAreaPosition(e){const i=this.properties.get("TextAreas");if((0,n.isObject)(i)){const t=i[e];if((0,o.isSerializedLineTextAreaPositioning)(t))return(0,o.deserializeLineTextAreaPositioning)(t)}}setTextAreaPosition(e,i){this.properties.set("TextAreas",{[e]:(0,o.serializeLineTextAreaPositioning)(i)})}addTextArea(e,i){return this.client.sendCommand("alta",{id:this.id,p:(0,o.serializeLineTextAreaPositioning)(i),t:e})}deleteTextArea(e){this.properties.set("TextAreas",{[e]:null})}}i.LineProxy=l},2849:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.serializeLineTextAreaPositioning=i.deserializeLineTextAreaPositioning=i.isSerializedLineTextAreaPositioning=void 0;const n=t(1225);i.isSerializedLineTextAreaPositioning=function(e){return(0,n.isObject)(e)&&(0,n.isNumber)(e.Location)&&(0,n.isNumber)(e.Side)&&((0,n.isBoolean)(e.AllowOverBlock)||(0,n.isUndefined)(e.AllowOverBlock))},i.deserializeLineTextAreaPositioning=function(e){return{location:e.Location,side:e.Side,allowOverBlock:e.AllowOverBlock}},i.serializeLineTextAreaPositioning=function(e){return{Location:e.location,Side:e.side,AllowOverBlock:e.allowOverBlock}}},5962:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WriteableMapProxy=i.MapProxy=void 0;class t{constructor(e,i){this.getKeys=e,this.getItem=i}*[Symbol.iterator](){for(const e of this.keys()){const i=this.get(e);void 0!==i&&(yield[e,i])}}*values(){for(const e of this.keys()){const i=this.get(e);void 0!==i&&(yield i)}}keys(){return this.getKeys()}get size(){return this.keys().length}get(e){return this.getItem(e)}first(){const e=this.keys();if(0!=e.length)return this.get(e[0])}}i.MapProxy=t,i.WriteableMapProxy=class extends t{constructor(e,i,t){super(e,i),this.setter=t}set(e,i){this.setter(e,i)}}},5774:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0})},3379:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PageProxy=void 0;const n=t(4229),s=t(7548),r=t(9746),o=t(5962);class l extends n.ElementProxy{constructor(e,i){super(e,i),this.id=e,this.blocks=new o.MapProxy((()=>this.client.sendCommand("lb",{id:this.id})),(e=>this.client.getBlockProxy(e))),this.lines=new o.MapProxy((()=>this.client.sendCommand("ll",{id:this.id})),(e=>new r.LineProxy(e,this.client))),this.groups=new o.MapProxy((()=>this.client.sendCommand("lg",{id:this.id})),(e=>new s.GroupProxy(e,this.client))),this.allBlocks=new o.MapProxy((()=>this.client.sendCommand("lb",{id:this.id,d:!0})),(e=>this.client.getBlockProxy(e))),this.allLines=new o.MapProxy((()=>this.client.sendCommand("ll",{id:this.id,d:!0})),(e=>new r.LineProxy(e,this.client))),this.allGroups=new o.MapProxy((()=>this.client.sendCommand("lg",{id:this.id,d:!0})),(e=>new s.GroupProxy(e,this.client)))}addBlock(e){const i=this.client.sendCommand("cb",{p:this.id,c:e.className,s:e.stencil}),t=this.client.getBlockProxy(i);if(t.setBoundingBox(e.boundingBox),e.properties)for(const i in e.properties)t.properties.set(i,e.properties[i]);return t}addLine(e){const i=this.client.sendCommand("cl",{p:this.id}),t=new r.LineProxy(i,this.client);return t.setEndpoint1(e.endpoint1),t.setEndpoint2(e.endpoint2),t}setTitle(e){this.properties.set("Title",e)}getTitle(){return this.properties.get("Title")}delete(){this.client.sendCommand("dp",this.id)}}i.PageProxy=l},5186:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PropertyStoreProxy=void 0;const n=t(5962);i.PropertyStoreProxy=class{constructor(e,i){this.id=e,this.client=i,this.properties=new n.WriteableMapProxy((()=>this.client.sendCommand("lpr",{id:this.id})),(e=>this.client.sendCommand("gp",{id:this.id,p:e})),((e,i)=>{if("BoundingBox"===e)throw new Error("Do not use properties.set() to move or resize items; use setLocation() or setBoundingBox() or offset()");this.client.sendCommand("sp",{id:this.id,p:e,v:i})}))}}},6355:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ShapeDataProxy=void 0;const n=t(2341),s=t(4812),r=t(7258),o=t(5962);class l extends o.WriteableMapProxy{constructor(e,i){super((()=>this.client.sendCommand("lsd",{id:this.id})),(e=>l.parseData(this.client.sendCommand("gsd",{id:this.id,n:e}))),((e,i)=>{if((0,n.isSerializedDataError)(i))throw new Error("Cannot store an error value");this.keys().includes(e)?this.client.sendCommand("ssd",{id:this.id,n:e,v:i}):this.client.sendCommand("asd",{id:this.id,i:s.ShapeDataInheritance.NONE,n:e,v:i})})),this.id=e,this.client=i}delete(e){this.keys().includes(e)&&this.client.sendCommand("dsd",{id:this.id,n:e})}static parseData(e){return(0,n.isSerializedDataError)(e)?new r.DataError(e.error,e.type):e}}i.ShapeDataProxy=l},1242:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.EditorClient=void 0;const n=t(9969),s=t(9501),r=t(9373),o=t(5663),l=t(912),a=t(4229),d=t(7548),c=t(9746),u=t(3379);i.EditorClient=class{constructor(){this.nextId=0,this.callbacks=new Map,this.listenToEditor()}getUniqueActionName(){for(;this.actionExists("a"+this.nextId);)this.nextId++;return"a"+this.nextId}killExtension(){this.sendCommand("k",void 0)}reloadExtension(){this.sendCommand("r",void 0)}download(e,i,t,n){this.sendCommand("d",{f:e,d:i,m:t,b64:n})}async performDataAction(e,i,t,n,s=!0){const r=await this.sendCommand("da",{fn:e,a:s,s:t,fd:n,n:i});return"t"in r?{status:r.c,text:r.t}:{status:r.c,json:r.j}}xhr(e){return this.sendCommand("xhr",{url:e.url,m:e.method,d:e.data,h:e.headers,ms:e.timeoutMs}).then((e=>({url:e.url,responseText:e.t,status:e.s,headers:e.h,timeout:e.to}))).catch((e=>{const i=(0,n.isRawSendXHRResponse)(e)?e:void 0;throw{url:i?i.url:"",responseText:i?i.t:"An unknown error occurred",status:i?i.s:0,headers:i?i.h:{},timeout:i?i.to:void 0}}))}oauthXhr(e,i){return this.sendCommand("oauth",{url:i.url,m:i.method,d:i.data,h:i.headers,ms:i.timeoutMs,p:e}).then((e=>({url:e.url,responseText:e.t,status:e.s,headers:e.h,timeout:e.to}))).catch((e=>{const i=((0,n.isRawSendXHRResponse)(e),e);throw{url:i.url,responseText:i.t,status:i.s,headers:i.h,timeout:i.to}}))}registerAction(e,i){if(this.actionExists(e))throw new Error("Action already exists: "+e);this.callbacks.set(e,i)}registerFileUploadAction(e,i){this.registerAction(e,(e=>{i(e.f.map((e=>e.b?{fileName:e.n,text:e.t,binary:(0,s.decodeBase64)(e.b)}:{fileName:e.n,text:e.t})))}))}deleteAction(e){this.callbacks.delete(e)}actionExists(e){return this.callbacks.has(e)}sendCommand(e,i){return lucid.executeCommand(e,i)}getBlockProxy(e){const i=this.sendCommand("gp",{id:e,p:"ClassName"}),t=(0,r.findProxyClass)(i);return t?new t(e,this):new o.BlockProxy(e,this)}loadBlockClasses(e){return this.sendCommand("lbc",e)}async getCustomShapeDefinition(e,i){await this.loadBlockClasses(["CustomBlock"]);const t=await this.sendCommand("gcs",{l:e,s:i});if(t)return{className:"CustomBlock",boundingBox:t.bb,stencil:t.s,properties:t.p}}async processAndClearBootstrapData(e,i){const t=this.getUniqueActionName();this.registerAction(t,(i=>e(i.d))),await this.sendCommand("b",{c:t,m:i}),this.deleteAction(t)}getLineProxy(e){return new c.LineProxy(e,this)}getPageProxy(e){return new u.PageProxy(e,this)}getItemProxy(e){const i=this.sendCommand("get",{id:e});switch(i){case"block":return this.getBlockProxy(e);case"line":return this.getLineProxy(e);case"group":return new d.GroupProxy(e,this);default:throw new Error("Element "+e+" is not an Item; type found is "+i)}}getElementProxy(e){switch(this.sendCommand("get",{id:e})){case"block":return this.getBlockProxy(e);case"line":return this.getLineProxy(e);case"page":return this.getPageProxy(e);case"document":return new l.DocumentProxy(this);case"group":return new d.GroupProxy(e,this);default:return new a.ElementProxy(e,this)}}listenToEditor(){lucid.listen((e=>{var i;return null===(i=this.callbacks.get(e.id))||void 0===i?void 0:i(e)}))}alert(e,i,t){return this.sendCommand("a",{t:i,b:e,bt:t})}confirm(e,i,t,n){return this.sendCommand("c",{t:i,b:e,o:t,c:n})}}},2652:function(e,i,t){var n=this&&this.__createBinding||(Object.create?function(e,i,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return i[t]}})}:function(e,i,t,n){void 0===n&&(n=t),e[n]=i[t]}),s=this&&this.__exportStar||function(e,i){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(i,t)||n(i,e,t)};Object.defineProperty(i,"__esModule",{value:!0}),s(t(289),i),s(t(6459),i),s(t(6122),i),s(t(7195),i),s(t(2341),i),s(t(4812),i),s(t(6443),i),s(t(7258),i),s(t(3081),i),s(t(1582),i),s(t(9594),i),s(t(9445),i),s(t(5663),i),s(t(912),i),s(t(4229),i),s(t(7548),i),s(t(251),i),s(t(9269),i),s(t(9746),i),s(t(5962),i),s(t(5774),i),s(t(3379),i),s(t(6355),i),s(t(1242),i),s(t(704),i),s(t(9433),i),s(t(4580),i),s(t(4199),i),s(t(404),i),s(t(4299),i)},704:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.padBox=i.combinedBoundingBox=void 0,i.combinedBoundingBox=function(e){if(0==e.length)return;let i=Number.MAX_VALUE,t=Number.MAX_VALUE,n=-Number.MAX_VALUE,s=-Number.MAX_VALUE;for(const r of e)i=Math.min(i,r.x),n=Math.max(n,r.x+r.w),t=Math.min(t,r.y),s=Math.max(s,r.y+r.h);return{x:i,y:t,w:n-i,h:s-t}},i.padBox=function(e,i){return{x:e.x-i,y:e.y-i,w:e.w+2*i,h:e.h+2*i}}},9433:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.AlertModal=void 0;const n=t(4199);class s extends n.Modal{constructor(e,i,t){super(e,{width:300,height:200,title:i,content:`\n<html>\n<head>\n<style type="text/css">\np {\n    font-family: 'Graphik LC Web', sans-serif;\n    font-size:14px;\n    text-align:center;\n}\n</style>\n</head>\n<body>\n<p id="message"></p>\n<script type="text/javascript">\n    var p = document.getElementById('message');\n    p.innerText = ${JSON.stringify(t)};\n<\/script>\n</body>\n</html>\n            `})}}i.AlertModal=s},5701:(e,i)=>{var t;Object.defineProperty(i,"__esModule",{value:!0}),i.IframeUI=i.IncomingUIMessageType=void 0,function(e){e[e.Closed=1]="Closed",e[e.PostMessageFromFrame=2]="PostMessageFromFrame",e[e.FrameLoaded=3]="FrameLoaded"}(t=i.IncomingUIMessageType||(i.IncomingUIMessageType={}));class n{constructor(e){this.client=e,this.id=++n.nextId,this.messageActionName=n.uiMessageActionNamePrefix+this.id,this.loaded=!1}static isUIMessageActionName(e){return e.startsWith(n.uiMessageActionNamePrefix)}hookMessages(){this.client.registerAction(this.messageActionName,(e=>{switch(e.t){case t.Closed:this.loaded=!1,this.frameClosed();break;case t.PostMessageFromFrame:this.messageFromFrame(e.data);break;case t.FrameLoaded:this.loaded=!0,this.frameLoaded()}}))}unhookMessages(){this.client.deleteAction(this.messageActionName)}sendMessage(e){this.loaded&&this.client.sendCommand("suim",{n:this.messageActionName,d:e})}messageFromFrame(e){}frameLoaded(){}frameClosed(){}}i.IframeUI=n,n.nextId=0,n.uiMessageActionNamePrefix="__ui_message__"},4580:(e,i)=>{var t,n;Object.defineProperty(i,"__esModule",{value:!0}),i.Menu=i.MenuLocation=i.MenuType=void 0,(n=i.MenuType||(i.MenuType={}))[n.Main=1]="Main",n[n.Context=2]="Context",(t=i.MenuLocation||(i.MenuLocation={}))[t.Extension=1]="Extension",t[t.Edit=2]="Edit",t[t.View=3]="View",t[t.Share=4]="Share",t[t.Export=5]="Export",t[t.Import=6]="Import",i.Menu=class{constructor(e){this.client=e}addMenuItem(e){if(e.action&&!this.client.actionExists(e.action))throw new Error("Unregistered action: "+e.action);if(e.visibleAction&&!this.client.actionExists(e.visibleAction))throw new Error("Unregistered action: "+e.visibleAction);if(e.disabledAction&&!this.client.actionExists(e.disabledAction))throw new Error("Unregistered action: "+e.disabledAction);this.client.sendCommand("ami",{l:e.label,a:e.action,v:e.visibleAction,d:e.disabledAction,t:e.menuType,loc:e.location,f:e.file?{a:e.file.action,ac:e.file.accept,s:e.file.singleFileOnly,b:e.file.binary}:void 0})}}},4199:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Modal=void 0;const n=t(5701);class s extends n.IframeUI{constructor(e,i){super(e),this.config=i,this.visible=!1}frameClosed(){this.unhookMessages()}show(){this.visible||(this.hookMessages(),this.client.sendCommand("sm",{n:this.messageActionName,t:this.config.title,w:this.config.width,h:this.config.height,c:this.config.content}),this.visible=!0)}hide(){this.visible&&(this.client.sendCommand("hm",{n:this.messageActionName}),this.visible=!1)}}i.Modal=s},404:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Panel=i.PanelLocation=void 0;const n=t(5701);var s;(s=i.PanelLocation||(i.PanelLocation={}))[s.RightDock=1]="RightDock";class r extends n.IframeUI{constructor(e,i){super(e),this.config=i,this.hookMessages(),this.client.sendCommand("rp",{n:this.messageActionName,t:this.config.title,l:this.config.location,c:this.config.content,v:this.config.visibleAction,i:this.config.iconUrl})}show(){this.client.sendCommand("spn",{n:this.messageActionName})}hide(){this.client.sendCommand("hp",{n:this.messageActionName})}}i.Panel=r},4299:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Viewport=void 0;const n=t(1225),s=t(251),r=t(3379),o=t(704);class l{constructor(e){this.client=e}static nextHookName(){return"__viewport__hook"+l.nextHookId++}getSelectedItems(e){return this.client.sendCommand("gs",{d:e}).map((e=>this.client.getElementProxy(e))).filter((e=>e instanceof s.ItemProxy))}getCurrentPage(){const e=this.client.sendCommand("gcp",void 0);return null==e?e:new r.PageProxy(e,this.client)}setCurrentPage(e){this.client.sendCommand("scp",e.id)}focusCameraOnItems(e){const i=(0,o.combinedBoundingBox)(e.map((e=>e.getBoundingBox())));i&&this.client.sendCommand("av",{bb:(0,o.padBox)(i,80),p:e[0].getPage().id})}hookTextEdit(e){const i=l.nextHookName();return this.client.registerAction(i,(async i=>{const t=this.client.getElementProxy(i.i);if(t instanceof s.ItemProxy){const s=await e(t,i.t);if((0,n.isBoolean)(s))return s;{const e=l.nextHookName();return this.client.registerAction(e,(i=>(this.client.deleteAction(e),s(i.v)))),e}}return!0})),this.client.sendCommand("hte",{n:i}),i}unhookTextEdit(e){this.client.deleteAction(e),this.client.sendCommand("ute",{n:e})}hookSelection(e){const i=l.nextHookName();return this.client.registerAction(i,(async i=>{const t=i.ids.map((e=>this.client.getElementProxy(e))).filter((e=>e instanceof s.ItemProxy));e(t)})),this.client.sendCommand("hs",{n:i}),i}unhookSelection(e){this.client.deleteAction(e),this.client.sendCommand("us",{n:e})}}i.Viewport=l,l.nextHookId=0},8047:(e,i,t)=>{t.r(i),t.d(i,{default:()=>n});const n="<html>\n    <body>\n        <p id=\"message\"></p>\n        <input type=\"file\" id=\"upload\"></input>\n\n        <script type=\"text/javascript\">\n        window.addEventListener('message', (e) => {\n            document.getElementById('message').innerText = e.data['message'];\n        });\n\n        const input = document.getElementById('upload');\n        input.addEventListener('change', (event) => {\n            if (input.files?.length == 1) {\n                const fr = new FileReader();\n                fr.onload = () => {\n                    parent.postMessage({\n                        name:input.files[0].name,\n                        content:fr.result,\n                    }, '*')\n                };\n                fr.readAsText(input.files[0]);\n            }\n        });\n\n        <\/script>\n    </body>\n</html>\n"},3823:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ImportModal=void 0;const n=t(2652),s=t(8047);class r extends n.Modal{constructor(e){super(e,{title:"Import a thing",width:600,height:400,content:s.default})}frameLoaded(){this.sendMessage({message:"Successfully passed message to iframe"})}messageFromFrame(e){console.log(e.name),console.log(e.content),this.hide()}}i.ImportModal=r}},i={};function t(n){var s=i[n];if(void 0!==s)return s.exports;var r=i[n]={exports:{}};return e[n].call(r.exports,r,r.exports,t),r.exports}t.d=(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},t.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=t(2652),i=t(3823),n=new e.EditorClient,s=new e.Menu(n),r=new e.Viewport(n),o=new e.DocumentProxy(n);async function l(e,i,t){await n.loadBlockClasses(["ProcessBlock"]),e.addBlock({className:"ProcessBlock",boundingBox:{x:i,y:t,w:200,h:160}}).textAreas.set("Text","The new shape")}n.registerAction("test",(()=>{const e=new i.ImportModal(n);console.log("This is working !!!"),e.show()})),n.registerAction("listPages",(()=>{let e=10,i=10;for(const[t,n]of o.pages)console.log(t,n.getTitle(),r.getCurrentPage()===n?"active":""),l(n,e,i),e+=10,i+=10})),s.addMenuItem({label:"Test thing",action:"listPages",menuType:e.MenuType.Main})})()})();